<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cardano Native Tokens - Top 100 Price List | Crypto Station</title>

    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8299108249562278"
         crossorigin="anonymous"></script>

<!-- ÂÖ±ÈÄö„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥CSS -->
    <link rel="stylesheet" href="nav-common.css?v=3">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            padding: 20px;
            color: #e0e0e0;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(30, 30, 50, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #0033ad 0%, #0052ff 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.2em;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        /* Search Bar */
        .search-section {
            padding: 20px 30px;
            background: rgba(255, 255, 255, 0.05);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .search-container {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }

        .search-input-wrapper {
            flex: 1;
            min-width: 300px;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 15px 20px 15px 50px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.05);
            color: #fff;
            font-size: 1em;
            transition: all 0.3s;
        }

        .search-input:focus {
            outline: none;
            border-color: #0052ff;
            background: rgba(255, 255, 255, 0.1);
        }

        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .search-icon {
            position: absolute;
            left: 18px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2em;
            color: rgba(255, 255, 255, 0.5);
        }

        .sort-select {
            padding: 15px 20px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.05);
            color: #fff;
            font-size: 1em;
            cursor: pointer;
        }

        .sort-select option {
            background: #1a1a2e;
            color: #fff;
        }

        .refresh-btn {
            background: linear-gradient(135deg, #0033ad, #0052ff);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .refresh-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 82, 255, 0.4);
        }

        .refresh-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* Stats Section */
        .stats-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            padding: 20px 30px;
            background: rgba(0, 0, 0, 0.2);
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-label {
            font-size: 0.85em;
            color: rgba(255,255,255,0.6);
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #0052ff;
        }

        /* Top Gainers Section */
        .gainers-section {
            padding: 20px 30px;
            background: rgba(0, 255, 136, 0.05);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .gainers-title {
            font-size: 1.3em;
            margin-bottom: 15px;
            color: #00ff88;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .gainers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 12px;
        }

        .gainer-card {
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.15), rgba(0, 255, 136, 0.05));
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid rgba(0, 255, 136, 0.2);
        }

        .gainer-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 255, 136, 0.2);
        }

        .gainer-rank {
            font-size: 0.75em;
            color: rgba(255, 255, 255, 0.5);
            margin-bottom: 5px;
        }

        .gainer-name {
            font-weight: bold;
            font-size: 0.95em;
            margin-bottom: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .gainer-symbol {
            font-size: 0.8em;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 8px;
        }

        .gainer-change {
            font-size: 1.1em;
            font-weight: bold;
            color: #00ff88;
        }

        /* Token Table */
        .table-section {
            padding: 20px 30px;
        }

        .table-wrapper {
            overflow-x: auto;
        }

        .token-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.95em;
        }

        .token-table th {
            background: rgba(0, 82, 255, 0.2);
            padding: 15px 12px;
            text-align: left;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s;
            white-space: nowrap;
        }

        .token-table th:hover {
            background: rgba(0, 82, 255, 0.3);
        }

        .token-table th.sortable {
            cursor: pointer;
            user-select: none;
            position: relative;
            padding-right: 20px;
        }

        .token-table th.sortable:hover {
            background: rgba(0, 82, 255, 0.4);
        }

        .token-table th.sortable::after {
            content: '‚áÖ';
            position: absolute;
            right: 5px;
            opacity: 0.4;
            font-size: 0.8em;
        }

        .token-table th.sorted-asc::after {
            content: '‚Üë';
            opacity: 1;
        }

        .token-table th.sorted-desc::after {
            content: '‚Üì';
            opacity: 1;
        }

        .token-table td {
            padding: 15px 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .token-table tbody tr {
            transition: background 0.2s;
        }

        .token-table tbody tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .token-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .token-logo {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
        }

        .token-name {
            font-weight: 600;
        }

        .token-symbol {
            font-size: 0.85em;
            color: rgba(255, 255, 255, 0.6);
        }

        .price-positive {
            color: #00ff88;
        }

        .price-negative {
            color: #ff4757;
        }

        .chart-link {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 6px 12px;
            background: linear-gradient(135deg, #ff6b35, #f7931a);
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-size: 0.85em;
            font-weight: 500;
            transition: all 0.3s;
        }

        .chart-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(247, 147, 26, 0.4);
        }

        /* Loading & Error States */
        .loading-overlay {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 60px 20px;
            color: rgba(255, 255, 255, 0.7);
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-top-color: #0052ff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .error-message {
            background: rgba(255, 71, 87, 0.2);
            border: 1px solid rgba(255, 71, 87, 0.3);
            color: #ff4757;
            padding: 20px;
            margin: 20px 30px;
            border-radius: 12px;
            text-align: center;
        }

        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            gap: 10px;
            padding: 20px;
        }

        .page-btn {
            padding: 10px 18px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .page-btn:hover:not(:disabled) {
            background: rgba(0, 82, 255, 0.3);
        }

        .page-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .page-btn.active {
            background: #0052ff;
            border-color: #0052ff;
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 2rem;
            color: rgba(255, 255, 255, 0.5);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .footer-links a {
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
        }

        .footer-links a:hover {
            text-decoration: underline;
        }

        .disclaimer {
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid rgba(255, 193, 7, 0.3);
            padding: 15px 20px;
            margin: 0 30px 20px;
            border-radius: 10px;
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9em;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.6em;
            }

            .search-input-wrapper {
                min-width: 100%;
            }

            .gainers-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .token-table {
                font-size: 0.85em;
            }

            .token-table th, .token-table td {
                padding: 10px 8px;
            }
        }

        /* Result count */
        .result-count {
            padding: 10px 30px;
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <!-- „Ç¶„Ç©„Éº„Çø„Éº„Éû„Éº„ÇØ„É≠„Ç¥ -->
    <img src="crypto-station_logo_black.png" alt="" class="watermark-logo">

    <!-- ÂÖ±ÈÄö„É°„Éã„É•„Éº -->
    <nav class="nav-menu">
        <div class="nav-container">
        <a href="index.html" class="logo-link">
            <img src="crypto-station_logo_whilte.png" alt="Crypto Station" class="site-logo light-logo">
            <img src="crypto-station_logo_black.png" alt="Crypto Station" class="site-logo dark-logo">
        </a>
            <ul class="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="cards.html">Crypto Cards</a></li>
                <li><a href="crypto-tax.html">Tax Information</a></li>
                <li><a href="ada-comparison.html">ADA Price</a></li>
                <li><a href="cardano-tokens.html" class="active">CNT Tokens</a></li>
                <li>
                    <div class="dropdown">
                        <a href="ai-trading.html">AI Trading</a>
                        <div class="dropdown-content">
                            <a href="https://gaussnet.crypto-station.org">ü§ñ GaussNet</a>
                            <a href="https://davincinet.crypto-station.org">üé® DaVinciNet</a>
                            <a href="https://einsteinnet.crypto-station.org">üî¨ EinsteinNet</a>
                        </div>
                    </div>
                </li>
                <li><a href="about.html">About</a></li>
                <li><a href="contact.html">Contact</a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <div class="header">
            <img src="cardano-ada-logo.svg"
                 alt="Cardano Logo"
                 width="50"
                 height="50"
                 style="display: inline-block; vertical-align: middle; margin-right: 15px;">
            <h1 style="display: inline-block; vertical-align: middle;">Cardano Native Tokens - Top 100</h1>
            <p>Real-time price data for Cardano ecosystem tokens</p>
        </div>

        <!-- Search Section -->
        <div class="search-section">
            <div class="search-container">
                <div class="search-input-wrapper">
                    <span class="search-icon">üîç</span>
                    <input type="text"
                           id="searchInput"
                           class="search-input"
                           placeholder="Search tokens by name or symbol...">
                </div>
                <select id="sortSelect" class="sort-select">
                    <option value="market_cap_desc">Market Cap ‚Üì</option>
                    <option value="market_cap_asc">Market Cap ‚Üë</option>
                    <option value="volume_desc">Volume ‚Üì</option>
                    <option value="volume_asc">Volume ‚Üë</option>
                    <option value="price_change_desc">24h Change ‚Üì</option>
                    <option value="price_change_asc">24h Change ‚Üë</option>
                </select>
                <button id="refreshBtn" class="refresh-btn">
                    üîÑ Refresh
                </button>
            </div>
        </div>

        <!-- Stats Section -->
        <div class="stats-section">
            <div class="stat-card">
                <div class="stat-label">Total Tokens</div>
                <div class="stat-value" id="totalTokens">--</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Total Market Cap</div>
                <div class="stat-value" id="totalMarketCap">--</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">24h Volume</div>
                <div class="stat-value" id="totalVolume">--</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Last Updated</div>
                <div class="stat-value" id="lastUpdate">--:--</div>
            </div>
        </div>

        <!-- Top Gainers Section -->
        <div class="gainers-section">
            <h2 class="gainers-title">üìà Top 10 Gainers (24h)</h2>
            <div class="gainers-grid" id="gainersGrid">
                <div class="loading-overlay">
                    <div class="loading-spinner"></div>
                    <span>Loading gainers...</span>
                </div>
            </div>
        </div>

        <!-- Error Message -->
        <div class="error-message" id="errorMessage" style="display: none;"></div>

        <!-- Result Count -->
        <div class="result-count" id="resultCount"></div>

        <!-- Token Table -->
        <div class="table-section">
            <div class="table-wrapper">
                <table class="token-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Token</th>
                            <th data-sort="current_price" class="sortable">Price (USD)</th>
                            <th data-sort="price_change_percentage_24h" class="sortable">24h %</th>
                            <th data-sort="market_cap" class="sortable sorted-desc">Market Cap</th>
                            <th data-sort="total_volume" class="sortable">Volume (24h)</th>
                            <th>Chart</th>
                        </tr>
                    </thead>
                    <tbody id="tokenTableBody">
                        <tr>
                            <td colspan="7">
                                <div class="loading-overlay">
                                    <div class="loading-spinner"></div>
                                    <span>Loading tokens...</span>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Pagination -->
        <div class="pagination" id="pagination"></div>

        <!-- Disclaimer -->
        <div class="disclaimer">
            <strong>‚ö†Ô∏è Disclaimer:</strong>
            Price data is provided by CoinGecko API and is for reference only.
            Chart links redirect to TapTools for detailed analysis.
            Cryptocurrency trading involves high risk. Always do your own research.
        </div>
    </div>

    <footer class="footer">
        <div class="footer-links">
            <a href="index.html">Home</a>
            <a href="about.html">About</a>
            <a href="contact.html">Contact</a>
            <a href="privacy-policy.html">Privacy Policy</a>
        </div>
        <p>&copy; 2025 Crypto Station. All rights reserved.</p>
    </footer>

    <script>
        // Configuration
        const COINGECKO_API = 'https://api.coingecko.com/api/v3';
        const CATEGORY = 'cardano-ecosystem';
        const PER_PAGE = 100;
        const ITEMS_PER_PAGE = 20;

        // State
        let allTokens = [];
        let filteredTokens = [];
        let currentPage = 1;
        let currentSort = { field: 'market_cap', order: 'desc' };
        let isLoading = false;

        // Add click event listener to table headers
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelector('.token-table thead').addEventListener('click', handleHeaderClick);
        });

        // DOM Elements
        const searchInput = document.getElementById('searchInput');
        const sortSelect = document.getElementById('sortSelect');
        const refreshBtn = document.getElementById('refreshBtn');
        const tokenTableBody = document.getElementById('tokenTableBody');
        const gainersGrid = document.getElementById('gainersGrid');
        const pagination = document.getElementById('pagination');
        const errorMessage = document.getElementById('errorMessage');
        const resultCount = document.getElementById('resultCount');

        // Utility Functions
        function formatPrice(price) {
            if (price === null || price === undefined) return 'N/A';
            if (price < 0.00001) return '$' + price.toExponential(2);
            if (price < 0.01) return '$' + price.toFixed(6);
            if (price < 1) return '$' + price.toFixed(4);
            return '$' + price.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        }

        function formatMarketCap(value) {
            if (!value) return 'N/A';
            if (value >= 1e9) return '$' + (value / 1e9).toFixed(2) + 'B';
            if (value >= 1e6) return '$' + (value / 1e6).toFixed(2) + 'M';
            if (value >= 1e3) return '$' + (value / 1e3).toFixed(2) + 'K';
            return '$' + value.toFixed(2);
        }

        function formatPercentage(value) {
            if (value === null || value === undefined) return 'N/A';
            const formatted = value.toFixed(2);
            return (value >= 0 ? '+' : '') + formatted + '%';
        }

        function getTapToolsUrl(coinId, symbol) {
            // TapTools uses the token symbol or CoinGecko ID for charts
            return `https://www.taptools.io/charts/token?pairID=${encodeURIComponent(symbol.toUpperCase())}`;
        }

        function getCoinGeckoChartUrl(coinId) {
            return `https://www.coingecko.com/en/coins/${coinId}`;
        }

        // API Functions
        async function fetchCardanoTokens() {
            const url = `${COINGECKO_API}/coins/markets?vs_currency=usd&category=${CATEGORY}&order=market_cap_desc&per_page=${PER_PAGE}&page=1&sparkline=false&price_change_percentage=24h`;

            const response = await fetch(url);
            if (!response.ok) {
                throw new Error(`API Error: ${response.status}`);
            }
            return await response.json();
        }

        // Render Functions
        function renderTopGainers() {
            const gainers = [...allTokens]
                .filter(t => t.price_change_percentage_24h !== null)
                .sort((a, b) => (b.price_change_percentage_24h || 0) - (a.price_change_percentage_24h || 0))
                .slice(0, 10);

            if (gainers.length === 0) {
                gainersGrid.innerHTML = '<p style="color: rgba(255,255,255,0.5);">No data available</p>';
                return;
            }

            gainersGrid.innerHTML = gainers.map((token, index) => `
                <div class="gainer-card" onclick="window.open('${getCoinGeckoChartUrl(token.id)}', '_blank')">
                    <div class="gainer-rank">#${index + 1}</div>
                    <div class="gainer-name">${token.name}</div>
                    <div class="gainer-symbol">${token.symbol.toUpperCase()}</div>
                    <div class="gainer-change">+${token.price_change_percentage_24h.toFixed(2)}%</div>
                </div>
            `).join('');
        }

        function renderTokenTable() {
            const start = (currentPage - 1) * ITEMS_PER_PAGE;
            const end = start + ITEMS_PER_PAGE;
            const pageTokens = filteredTokens.slice(start, end);

            if (pageTokens.length === 0) {
                tokenTableBody.innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; padding: 40px; color: rgba(255,255,255,0.5);">
                            No tokens found matching your search
                        </td>
                    </tr>
                `;
                return;
            }

            tokenTableBody.innerHTML = pageTokens.map((token, index) => {
                const priceChangeClass = (token.price_change_percentage_24h || 0) >= 0 ? 'price-positive' : 'price-negative';
                const globalIndex = start + index + 1;

                return `
                    <tr>
                        <td>${globalIndex}</td>
                        <td>
                            <div class="token-info">
                                <img class="token-logo"
                                     src="${token.image}"
                                     alt="${token.name}"
                                     onerror="this.src='cardano-ada-logo.svg'">
                                <div>
                                    <div class="token-name">${token.name}</div>
                                    <div class="token-symbol">${token.symbol.toUpperCase()}</div>
                                </div>
                            </div>
                        </td>
                        <td>${formatPrice(token.current_price)}</td>
                        <td class="${priceChangeClass}">${formatPercentage(token.price_change_percentage_24h)}</td>
                        <td>${formatMarketCap(token.market_cap)}</td>
                        <td>${formatMarketCap(token.total_volume)}</td>
                        <td>
                            <a class="chart-link" href="${getCoinGeckoChartUrl(token.id)}" target="_blank">
                                üìä Chart
                            </a>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function renderPagination() {
            const totalPages = Math.ceil(filteredTokens.length / ITEMS_PER_PAGE);

            if (totalPages <= 1) {
                pagination.innerHTML = '';
                return;
            }

            let html = '';

            html += `<button class="page-btn" onclick="goToPage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>‚Üê Prev</button>`;

            for (let i = 1; i <= totalPages; i++) {
                if (i === 1 || i === totalPages || (i >= currentPage - 1 && i <= currentPage + 1)) {
                    html += `<button class="page-btn ${i === currentPage ? 'active' : ''}" onclick="goToPage(${i})">${i}</button>`;
                } else if (i === currentPage - 2 || i === currentPage + 2) {
                    html += '<span style="color: rgba(255,255,255,0.5);">...</span>';
                }
            }

            html += `<button class="page-btn" onclick="goToPage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>Next ‚Üí</button>`;

            pagination.innerHTML = html;
        }

        function updateStats() {
            document.getElementById('totalTokens').textContent = allTokens.length;

            const totalMcap = allTokens.reduce((sum, t) => sum + (t.market_cap || 0), 0);
            document.getElementById('totalMarketCap').textContent = formatMarketCap(totalMcap);

            const totalVol = allTokens.reduce((sum, t) => sum + (t.total_volume || 0), 0);
            document.getElementById('totalVolume').textContent = formatMarketCap(totalVol);

            const now = new Date();
            document.getElementById('lastUpdate').textContent =
                `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
        }

        function updateResultCount() {
            const searchTerm = searchInput.value.trim();
            if (searchTerm) {
                resultCount.textContent = `Found ${filteredTokens.length} tokens matching "${searchTerm}"`;
            } else {
                resultCount.textContent = `Showing ${filteredTokens.length} tokens`;
            }
        }

        // Filter & Sort Functions
        function filterTokens() {
            const searchTerm = searchInput.value.toLowerCase().trim();

            if (!searchTerm) {
                filteredTokens = [...allTokens];
            } else {
                filteredTokens = allTokens.filter(token =>
                    token.name.toLowerCase().includes(searchTerm) ||
                    token.symbol.toLowerCase().includes(searchTerm)
                );
            }

            sortTokens();
        }

        function sortTokens() {
            filteredTokens.sort((a, b) => {
                const aVal = a[currentSort.field] || 0;
                const bVal = b[currentSort.field] || 0;
                return currentSort.order === 'desc' ? bVal - aVal : aVal - bVal;
            });

            currentPage = 1;
            renderTokenTable();
            renderPagination();
            updateResultCount();
            updateSortHeaders();
        }

        function updateSortHeaders() {
            document.querySelectorAll('.token-table th.sortable').forEach(th => {
                th.classList.remove('sorted-asc', 'sorted-desc');
                if (th.dataset.sort === currentSort.field) {
                    th.classList.add(currentSort.order === 'asc' ? 'sorted-asc' : 'sorted-desc');
                }
            });
        }

        function handleHeaderClick(e) {
            const th = e.target.closest('th.sortable');
            if (!th) return;

            const field = th.dataset.sort;
            if (currentSort.field === field) {
                currentSort.order = currentSort.order === 'desc' ? 'asc' : 'desc';
            } else {
                currentSort.field = field;
                currentSort.order = 'desc';
            }

            sortTokens();
        }

        // Navigation
        function goToPage(page) {
            const totalPages = Math.ceil(filteredTokens.length / ITEMS_PER_PAGE);
            if (page < 1 || page > totalPages) return;

            currentPage = page;
            renderTokenTable();
            renderPagination();

            document.querySelector('.table-section').scrollIntoView({ behavior: 'smooth' });
        }

        // Main Data Loading
        async function loadData() {
            if (isLoading) return;

            isLoading = true;
            refreshBtn.disabled = true;
            errorMessage.style.display = 'none';

            tokenTableBody.innerHTML = `
                <tr>
                    <td colspan="7">
                        <div class="loading-overlay">
                            <div class="loading-spinner"></div>
                            <span>Loading tokens...</span>
                        </div>
                    </td>
                </tr>
            `;

            gainersGrid.innerHTML = `
                <div class="loading-overlay" style="grid-column: 1/-1;">
                    <div class="loading-spinner"></div>
                    <span>Loading gainers...</span>
                </div>
            `;

            try {
                allTokens = await fetchCardanoTokens();
                filteredTokens = [...allTokens];

                updateStats();
                renderTopGainers();
                filterTokens();

            } catch (error) {
                console.error('Error loading data:', error);
                errorMessage.textContent = `Error loading data: ${error.message}. Please try again later.`;
                errorMessage.style.display = 'block';

                tokenTableBody.innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; padding: 40px; color: rgba(255,255,255,0.5);">
                            Failed to load data. Please refresh to try again.
                        </td>
                    </tr>
                `;
                gainersGrid.innerHTML = '<p style="color: rgba(255,255,255,0.5);">Failed to load data</p>';
            } finally {
                isLoading = false;
                refreshBtn.disabled = false;
            }
        }

        // Event Listeners
        searchInput.addEventListener('input', () => {
            filterTokens();
        });

        sortSelect.addEventListener('change', () => {
            sortTokens();
        });

        refreshBtn.addEventListener('click', loadData);

        // Set active nav item
        function setActiveMenuItem() {
            const currentPath = window.location.pathname;
            const currentFile = currentPath.split('/').pop() || 'index.html';
            document.querySelectorAll('.nav-links a').forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('href').split('/').pop() === currentFile) {
                    item.classList.add('active');
                }
            });
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            setActiveMenuItem();
            loadData();
        });

        // Auto refresh every 2 minutes
        setInterval(loadData, 2 * 60 * 1000);
    </script>
</body>
</html>
<!-- Deploy test Fri  5 Dec 2025 11:57:02 AEDT -->
